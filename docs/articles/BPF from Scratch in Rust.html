<!DOCTYPE html><html lang="en" class="scroll-smooth bg-white dark:bg-black antialiased __variable_e39583"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="https://yeet.cx/landing-assets/_next/static/css/bcc59eca98b71e9e.css" data-precedence="next"/><link rel="stylesheet" href="https://yeet.cx/landing-assets/_next/static/css/e142c0e1edc5ec2b.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="https://yeet.cx/landing-assets/_next/static/chunks/webpack-a1f87996eace2985.js"/><script src="https://yeet.cx/landing-assets/_next/static/chunks/fd9d1056-7a77c00dafdfece2.js" async=""></script><script src="https://yeet.cx/landing-assets/_next/static/chunks/2117-f198b3529c769969.js" async=""></script><script src="https://yeet.cx/landing-assets/_next/static/chunks/main-app-d9d0995cc37b18e7.js" async=""></script><script src="https://yeet.cx/landing-assets/_next/static/chunks/9da6db1e-04e8cfb07900d0e9.js" async=""></script><script src="https://yeet.cx/landing-assets/_next/static/chunks/b4938aab-d2bdb82c799a9985.js" async=""></script><script src="https://yeet.cx/landing-assets/_next/static/chunks/9560-bc97d5c48e0404b5.js" async=""></script><script src="https://yeet.cx/landing-assets/_next/static/chunks/605-a76a7fa5deaa64f3.js" async=""></script><script src="https://yeet.cx/landing-assets/_next/static/chunks/7930-c02b706647238efd.js" async=""></script><script src="https://yeet.cx/landing-assets/_next/static/chunks/1166-eae33ead6c03129f.js" async=""></script><script src="https://yeet.cx/landing-assets/_next/static/chunks/5437-eafa6373ab6aaff8.js" async=""></script><script src="https://yeet.cx/landing-assets/_next/static/chunks/1740-3c33bac6317a6815.js" async=""></script><script src="https://yeet.cx/landing-assets/_next/static/chunks/702-95471d26c1713cd1.js" async=""></script><script src="https://yeet.cx/landing-assets/_next/static/chunks/1394-5f691a7052e7110f.js" async=""></script><script src="https://yeet.cx/landing-assets/_next/static/chunks/2288-2f7ff08a5c9ef7ac.js" async=""></script><script src="https://yeet.cx/landing-assets/_next/static/chunks/1270-1ec7192372faba91.js" async=""></script><script src="https://yeet.cx/landing-assets/_next/static/chunks/1237-9a220d7e3f5b5206.js" async=""></script><script src="https://yeet.cx/landing-assets/_next/static/chunks/app/blog/%5Bslug%5D/page-98fb4bb0a6e14b7d.js" async=""></script><script src="https://yeet.cx/landing-assets/_next/static/chunks/5240-bddfc6431af5ad58.js" async=""></script><script src="https://yeet.cx/landing-assets/_next/static/chunks/app/blog/%5Bslug%5D/layout-f23ba9febc31ddc4.js" async=""></script><script src="https://yeet.cx/landing-assets/_next/static/chunks/app/layout-e150284872b32f1b.js" async=""></script><script src="https://yeet.cx/landing-assets/_next/static/chunks/app/not-found-b012be08d98b8ed6.js" async=""></script><title>BPF from Scratch in Rust</title><meta name="description" content="How to write a BPF program from scratch in pure Rust."/><meta property="og:title" content="BPF from Scratch in Rust"/><meta property="og:description" content="How to write a BPF program from scratch in pure Rust."/><meta property="og:image" content="https://yeet.property/cdn-cgi/image/width=1200,height=620/landing-assets/blog/bpf-from-scratch-in-rust/opengraph-image.png"/><meta property="og:image:width" content="1200"/><meta property="og:image:height" content="620"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="BPF from Scratch in Rust"/><meta name="twitter:description" content="How to write a BPF program from scratch in pure Rust."/><meta name="twitter:image" content="https://yeet.property/cdn-cgi/image/width=1200,height=620/landing-assets/blog/bpf-from-scratch-in-rust/opengraph-image.png"/><meta name="twitter:image:width" content="1200"/><meta name="twitter:image:height" content="620"/><link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="144x135"/><meta name="next-size-adjust"/><link rel="preconnect" href="https://yeet.property" crossorigin="anonymous"/><link rel="preload" as="font" href="https://yeet.property/landing-assets/fonts/Iosevka_33.2.8/Iosevka-Thin.woff2" type="font/woff2" crossorigin="anonymous"/><link rel="preload" as="font" href="https://yeet.property/landing-assets/fonts/Iosevka_33.2.8/Iosevka-ExtraLight.woff2" type="font/woff2" crossorigin="anonymous"/><link rel="preload" as="font" href="https://yeet.property/landing-assets/fonts/Iosevka_33.2.8/Iosevka-Light.woff2" type="font/woff2" crossorigin="anonymous"/><link rel="preload" as="font" href="https://yeet.property/landing-assets/fonts/Iosevka_33.2.8/Iosevka-Regular.woff2" type="font/woff2" crossorigin="anonymous"/><link rel="preload" as="font" href="https://yeet.property/landing-assets/fonts/Iosevka_33.2.8/Iosevka-Medium.woff2" type="font/woff2" crossorigin="anonymous"/><link rel="preload" as="font" href="https://yeet.property/landing-assets/fonts/Iosevka_33.2.8/Iosevka-SemiBold.woff2" type="font/woff2" crossorigin="anonymous"/><link rel="preload" as="font" href="https://yeet.property/landing-assets/fonts/Iosevka_33.2.8/Iosevka-Bold.woff2" type="font/woff2" crossorigin="anonymous"/><link rel="preload" as="font" href="https://yeet.property/landing-assets/fonts/Iosevka_33.2.8/Iosevka-ExtraBold.woff2" type="font/woff2" crossorigin="anonymous"/><link rel="preload" as="font" href="https://yeet.property/landing-assets/fonts/Iosevka_33.2.8/Iosevka-Heavy.woff2" type="font/woff2" crossorigin="anonymous"/><link rel="preload" as="font" href="https://yeet.property/landing-assets/fonts/RuneScape/RuneScape-Bold-12.woff2" type="font/woff2" crossorigin="anonymous"/><script src="https://yeet.cx/landing-assets/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script><script data-cfasync="false" nonce="306e10be-4721-4469-95cc-89e168422f3e">try{(function(w,d){!function(fv,fw,fx,fy){if(fv.zaraz)console.error("zaraz is loaded twice");else{fv[fx]=fv[fx]||{};fv[fx].executed=[];fv.zaraz={deferred:[],listeners:[]};fv.zaraz._v="5858";fv.zaraz._n="306e10be-4721-4469-95cc-89e168422f3e";fv.zaraz.q=[];fv.zaraz._f=function(fz){return async function(){var fA=Array.prototype.slice.call(arguments);fv.zaraz.q.push({m:fz,a:fA})}};for(const fB of["track","set","debug"])fv.zaraz[fB]=fv.zaraz._f(fB);fv.zaraz.init=()=>{var fC=fw.getElementsByTagName(fy)[0],fD=fw.createElement(fy),fE=fw.getElementsByTagName("title")[0];fE&&(fv[fx].t=fw.getElementsByTagName("title")[0].text);fv[fx].x=Math.random();fv[fx].w=fv.screen.width;fv[fx].h=fv.screen.height;fv[fx].j=fv.innerHeight;fv[fx].e=fv.innerWidth;fv[fx].l=fv.location.href;fv[fx].r=fw.referrer;fv[fx].k=fv.screen.colorDepth;fv[fx].n=fw.characterSet;fv[fx].o=(new Date).getTimezoneOffset();if(fv.dataLayer)for(const fF of Object.entries(Object.entries(dataLayer).reduce(((fG,fH)=>({...fG[1],...fH[1]})),{})))zaraz.set(fF[0],fF[1],{scope:"page"});fv[fx].q=[];for(;fv.zaraz.q.length;){const fI=fv.zaraz.q.shift();fv[fx].q.push(fI)}fD.defer=!0;for(const fJ of[localStorage,sessionStorage])Object.keys(fJ||{}).filter((fL=>fL.startsWith("_zaraz_"))).forEach((fK=>{try{fv[fx]["z_"+fK.slice(7)]=JSON.parse(fJ.getItem(fK))}catch{fv[fx]["z_"+fK.slice(7)]=fJ.getItem(fK)}}));fD.referrerPolicy="origin";fD.src="/zzmain?z="+btoa(encodeURIComponent(JSON.stringify(fv[fx])));fC.parentNode.insertBefore(fD,fC)};["complete","interactive"].includes(fw.readyState)?zaraz.init():fv.addEventListener("DOMContentLoaded",zaraz.init)}}(w,d,"zarazData","script");window.zaraz._p=async eC=>new Promise((eD=>{if(eC){eC.e&&eC.e.forEach((eE=>{try{const eF=d.querySelector("script[nonce]"),eG=eF?.nonce||eF?.getAttribute("nonce"),eH=d.createElement("script");eG&&(eH.nonce=eG);eH.innerHTML=eE;eH.onload=()=>{d.head.removeChild(eH)};d.head.appendChild(eH)}catch(eI){console.error(`Error executing script: ${eE}\n`,eI)}}));Promise.allSettled((eC.f||[]).map((eJ=>fetch(eJ[0],eJ[1]))))}eD()}));zaraz._p({"e":["(function(w,d){})(window,document)"]});})(window,document)}catch(e){throw fetch("/zzt"),e;};</script></head><body><!--$--><!--/$--><div class="sticky h-fit top-0 z-20 flex flex-col"><div class="h-fit flex items-center justify-center bg-green-300 dark:bg-yellow-200 text-black px-4 transition-all duration-300 relative max-h-fit py-4"><div class=" flex flex-col md:flex-row grow justify-center items-center gap-2 h-full flex-wrap px-10 "><div class="flex justify-center items-center font-bold"><span class="mr-2">üßë‚Äçüç≥</span>Recipes are here!</div><div class="flex justify-center items-center font-medium text-center italic">Get quick performance insights on your GPU, CPU, network, and more.</div><a class=" flex font-medium justify-center items-center bg-violet-800 rounded-md px-4 py-2 text-white hover:bg-violet-900 " href="/discover">Start Cooking<span class="ml-2">üç≥</span></a></div><button class=" cursor-pointer hover:bg-black/25 rounded-full p-2 absolute right-4 top-1/2 -translate-y-1/2 "><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-x"><path d="M18 6 6 18"></path><path d="m6 6 12 12"></path></svg></button></div><nav class="w-full max-h-screen flex flex-col bg-white dark:bg-black h-[70px] relative py-2"><div class="w-full flex justify-center items-center px-4 h-full"><div class="w-full h-full flex lg:grid lg:grid-cols-[1fr_3fr_1fr]"><a class="min-w-12 h-full flex grow items-center gap-4" href="/"><img alt="yeet" loading="lazy" width="48" height="48" decoding="async" data-nimg="1" style="color:transparent;width:auto;height:auto" srcSet="https://yeet.property/cdn-cgi/image/width=48/landing-assets/fecm.png 1x, https://yeet.property/cdn-cgi/image/width=96/landing-assets/fecm.png 2x" src="https://yeet.property/cdn-cgi/image/width=96/landing-assets/fecm.png"/><div class="font-bold text-2xl inline-block">yeet</div></a><div class="grow h-full hidden lg:flex gap-5 justify-center items-center"><a id="nav-bar-link-solutions" class=" h-4/5 flex gap-2 items-center justify-center font-semibold text-left " href="/solutions"><span class="hover:font-bold">Solutions</span> <!-- -->üíØ</a><a id="nav-bar-link-discover" class=" h-4/5 flex gap-2 items-center justify-center font-semibold text-left " href="/discover"><span class="hover:font-bold">Discover</span> <!-- -->üõ∞Ô∏è</a><a id="nav-bar-link-blog" class=" h-4/5 flex gap-2 items-center justify-center font-semibold text-left " href="/blog"><span class="hover:font-bold">Blog</span> <!-- -->‚úèÔ∏è</a><a id="nav-bar-link-pricing" class=" h-4/5 flex gap-2 items-center justify-center font-semibold text-left " href="/pricing"><span class="hover:font-bold">Pricing</span> <!-- -->üí∞</a><a id="nav-bar-link-careers" class=" h-4/5 flex gap-2 items-center justify-center font-semibold text-left " href="/careers"><span class="hover:font-bold">Careers</span> <!-- -->üå±</a><a id="nav-bar-link-about" class=" h-4/5 flex gap-2 items-center justify-center font-semibold text-left " href="/about"><span class="hover:font-bold">About</span> <!-- -->üéûÔ∏è</a></div><div class="h-full flex gap-2 items-center justify-end py-2"><div class="flex h-9 gap-4 items-center justify-center"><a id="nav-bar-cta-link-discord" class="w-8 h-8 hidden xl:block" href="https://discord.gg/bBRF9d2Gw2"><img alt="Discord" loading="lazy" width="30" height="30" decoding="async" data-nimg="1" class="invert dark:invert-0 hover:scale-110 transition-all" style="color:transparent" srcSet="https://yeet.property/cdn-cgi/image/width=32/landing-assets/social_logos/discord.png 1x, https://yeet.property/cdn-cgi/image/width=64/landing-assets/social_logos/discord.png 2x" src="https://yeet.property/cdn-cgi/image/width=64/landing-assets/social_logos/discord.png"/></a><a id="nav-bar-cta-link-github" class="w-8 h-8 hidden xl:block" href="https://github.com/yeet-src"><img alt="Github" loading="lazy" width="30" height="30" decoding="async" data-nimg="1" class="invert dark:invert-0 hover:scale-110 transition-all" style="color:transparent" srcSet="https://yeet.property/cdn-cgi/image/width=32/landing-assets/social_logos/github.png 1x, https://yeet.property/cdn-cgi/image/width=64/landing-assets/social_logos/github.png 2x" src="https://yeet.property/cdn-cgi/image/width=64/landing-assets/social_logos/github.png"/></a><div class="w-fit h-full pl-4 flex gap-2"><a class=" w-24 h-full hidden lg:flex items-center justify-center rounded-md text-white font-medium bg-black dark:text-black dark:bg-white hover:opacity-80 dark:hover:opacity-90 " href="/login">Login <span class="ml-2">üå¥</span></a><a class=" w-36 h-full hidden md:flex items-center justify-center rounded-md text-white font-medium bg-blue-600 hover:opacity-80 dark:hover:opacity-90 " href="/login">Get yeet free <span class="ml-2">üéâ</span></a></div></div><button class="p-2 block lg:hidden hover:opacity-80 cursor-pointer"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-menu w-8 h-8 hover:opacity-80 dark:hover:opacity-90"><line x1="4" x2="20" y1="12" y2="12"></line><line x1="4" x2="20" y1="6" y2="6"></line><line x1="4" x2="20" y1="18" y2="18"></line></svg></button></div></div></div></nav></div><div class="max-w-xs min-w-0 sm:max-w-md md:max-w-3xl mx-auto my-16"><div class=" flex items-center gap-6 text-sm justify-between text-gray-600 dark:text-gray-300 mb-8 pb-6 border-b border-gray-200 dark:border-gray-700 "><div class="flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-calendar w-4 h-4"><path d="M8 2v4"></path><path d="M16 2v4"></path><rect width="18" height="18" x="3" y="4" rx="2"></rect><path d="M3 10h18"></path></svg><time dateTime="2025-04-03">April 3, 2025</time></div><div class="flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-clock w-4 h-4"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg><span>10<!-- --> min read</span></div></div><h1 class="text-5xl font-bold tracking-tighter py-2 mt-4">BPF from Scratch in Rust</h1><div class=" flex items-center gap-6 text-sm mb-4 "><div class="flex items-center gap-2"><div class="flex items-center gap-2"><span class="font-medium text-gray-900 dark:text-gray-300 text-lg">By: <!-- -->Julian Goldstein</span></div></div></div><p class="my-4 tracking-wide">We‚Äôre not saying <a class="text-blue-500 hover:text-blue-600 underline" href="https://yeet.cx/">yeet</a> is the Dr. Dre of observability‚Ä¶
but it‚Äôs been in the lab with a pen and a pad trying to get the kernel off its back.</p>
<p class="my-4 tracking-wide">Not just at the level of <em class="italic">‚Äúhow do I write a tracing program,‚Äù</em> but ‚Äú<em class="italic">how do I build an entire
dynamic runtime on top of the Linux kernel‚Äôs deepest, weirdest, most misunderstood subsystem ‚Äî without
losing our minds (or yours).‚Äù</em></p>
<p class="my-4 tracking-wide">If you‚Äôre just here to play around, we even built a <a class="text-blue-500 hover:text-blue-600 underline" href="https://yeet.cx/play">sandbox</a>
where you can run real BPF programs (safely!) without touching your local machine.</p>
<p class="my-4 tracking-wide">For those who have never heard of BPF, you can think of it as a virtual machine you can
program to change the behavior of the Linux kernel in a way that is guaranteed not to crash it!
Linux statically proves the safety and termination of any given program before executing it in
kernel space using a complex process called <a class="text-blue-500 hover:text-blue-600 underline" href="https://github.com/torvalds/linux/blob/master/kernel/bpf/verifier.c">verification</a>.</p>
<p class="my-4 tracking-wide"><span class="flex justify-center w-full"><img alt="Ken &amp; Dennis" loading="lazy" width="700" height="700" decoding="async" data-nimg="1" style="color:transparent" srcSet="https://yeet.property/cdn-cgi/image/width=750/landing-assets/blog/bpf-from-scratch-in-rust/ken-and-dennis.png 1x, https://yeet.property/cdn-cgi/image/width=1920/landing-assets/blog/bpf-from-scratch-in-rust/ken-and-dennis.png 2x" src="https://yeet.property/cdn-cgi/image/width=1920/landing-assets/blog/bpf-from-scratch-in-rust/ken-and-dennis.png"/></span></p>
<p class="my-4 tracking-wide">The more we push the limits of what BPF can do, the more we find ourselves diving beneath the abstractions¬†
‚Äî unraveling low-level internals, deciphering verifier riddles, and occasionally losing our grip on reality‚Ä¶
all so <strong>you don‚Äôt have to</strong>.</p>
<p class="my-4 tracking-wide">So today, we‚Äôre going to do something a little ridiculous, a little beautiful, and (honestly) kind of empowering:</p>
<!-- -->
<h2 class="text-4xl font-bold tracking-tighter py-2 mt-4"><strong>We‚Äôre going to write a BPF program in Rust. From scratch.</strong></h2>
<p class="my-4 tracking-wide">‚úÖ¬†No macros.</p>
<p class="my-4 tracking-wide">‚úÖ¬†No frameworks.</p>
<p class="my-4 tracking-wide">‚úÖ¬†No hidden helpers.</p>
<p class="my-4 tracking-wide">‚úÖ¬†No getting roundhouse kicked in the face by the verifier (Rex-Kwon-Do style, of course).</p>
<p class="my-4 tracking-wide"><span class="flex justify-center w-full"><img alt="Rex Kwon Do" loading="lazy" width="700" height="700" decoding="async" data-nimg="1" style="color:transparent" srcSet="https://yeet.property/cdn-cgi/image/width=750/landing-assets/blog/bpf-from-scratch-in-rust/rex-kwon-do.gif 1x, https://yeet.property/cdn-cgi/image/width=1920/landing-assets/blog/bpf-from-scratch-in-rust/rex-kwon-do.gif 2x" src="https://yeet.property/cdn-cgi/image/width=1920/landing-assets/blog/bpf-from-scratch-in-rust/rex-kwon-do.gif"/></span></p>
<h1 class="text-5xl font-bold tracking-tighter py-2 mt-4">Setting up the Rust build toolchain</h1>
<p class="my-4 tracking-wide">Let‚Äôs start by creating a new Rust project:</p>
<pre class="border border-gray-300 rounded-md p-4 my-2 overflow-x-auto"><code class="language-bash highlight">cargo new bpf-from-scratch
</code></pre>
<p class="my-4 tracking-wide">Since the Rust toolchain uses LLVM as its backend to produce byte-code, it should be perfectly capable of producing
linking BPF binaries that <code style="word-break:break-word" class="bg-gray-100 dark:bg-gray-800 p-1 rounded-md text-red-600 dark:text-amber-300">yeetd</code> can run. We just have to supply the proper configuration.</p>
<p class="my-4 tracking-wide">Here‚Äôs the minimal <code style="word-break:break-word" class="bg-gray-100 dark:bg-gray-800 p-1 rounded-md text-red-600 dark:text-amber-300">.cargo/config.toml</code> you‚Äôll need:</p>
<pre class="border border-gray-300 rounded-md p-4 my-2 overflow-x-auto"><code class="language-toml highlight">[build]
target = &quot;bpfel-unknown-none&quot;
rustflags = [
  &quot;-C&quot;, &quot;debuginfo=2&quot;,
  &quot;-C&quot;, &quot;link-arg=--btf&quot;,
  &quot;-C&quot;, &quot;panic=abort&quot;
]

[unstable]
build-std = [&quot;core&quot;]
</code></pre>
<p class="my-4 tracking-wide">This tells <code style="word-break:break-word" class="bg-gray-100 dark:bg-gray-800 p-1 rounded-md text-red-600 dark:text-amber-300">cargo</code> to build our Rust code for Linux‚Äôs BPF virtual machine without the standard library
with debug info and BTF support ‚Äî just what <code style="word-break:break-word" class="bg-gray-100 dark:bg-gray-800 p-1 rounded-md text-red-600 dark:text-amber-300">yeetd</code> expects.</p>
<!-- -->
<h1 class="text-5xl font-bold tracking-tighter py-2 mt-4">Writing the world‚Äôs tiniest BPF program (in Rust)</h1>
<p class="my-4 tracking-wide">Time to touch the void. We‚Äôre going to write a <strong>real, working BPF program</strong> in pure Rust.</p>
<p class="my-4 tracking-wide">No C anywhere. Just <code style="word-break:break-word" class="bg-gray-100 dark:bg-gray-800 p-1 rounded-md text-red-600 dark:text-amber-300">#![no_std]</code>, a few <code style="word-break:break-word" class="bg-gray-100 dark:bg-gray-800 p-1 rounded-md text-red-600 dark:text-amber-300">#[link_section]</code>s, and direct calls into the kernel ‚Äî with some <strong>inline BPF assembly</strong> to finish it off.</p>
<p class="my-4 tracking-wide">This is the smallest thing we can give the verifier that still makes the kernel go:</p>
<p class="my-4 tracking-wide"><em class="italic">‚ÄúYeah, alright. You can run that.‚Äù</em></p>
<p class="my-4 tracking-wide">This program is rather simple: It hooks into a tracepoint (<code style="word-break:break-word" class="bg-gray-100 dark:bg-gray-800 p-1 rounded-md text-red-600 dark:text-amber-300">sys_enter_nanosleep</code>), increments a counter, and uses <code style="word-break:break-word" class="bg-gray-100 dark:bg-gray-800 p-1 rounded-md text-red-600 dark:text-amber-300">bpf_trace_printk()</code> to print a message to the trace pipe.</p>
<p class="my-4 tracking-wide">Short, structured, and slightly cursed.</p>
<p class="my-4 tracking-wide">In the project‚Äôs <code style="word-break:break-word" class="bg-gray-100 dark:bg-gray-800 p-1 rounded-md text-red-600 dark:text-amber-300">src/main.rs</code> file we write:</p>
<pre class="border border-gray-300 rounded-md p-4 my-2 overflow-x-auto"><code class="language-rust highlight">#![no_std]
#![no_main]
#![feature(asm_experimental_arch)]
use core::arch::asm;
use core::panic::PanicInfo;

static mut COUNTER: u64 = 0;
static FMT: [u8; 16] = *b&quot;hello kernel %d\0&quot;;

#[link_section = &quot;license&quot;]
#[no_mangle]
#[used]
static LICENSE: [u8; 12] = *b&quot;Dual BSD/GPL&quot;;

#[link_section = &quot;tracepoint/syscalls/sys_enter_nanosleep&quot;]
#[no_mangle]
pub unsafe fn test(_ctx: *mut u8) -&gt; i32 {
    asm!(
        r#&quot;
        r1 = {0}
        r4 = *(u32 *)(r1 + 0)
        r4 += 1
        *(u32 *)(r1 + 0) = r4
        r1 = {1}
        r2 = 16
        r3 = r4
        call 6
    &quot;#,
    in(reg) &amp;raw const COUNTER as *const u64,
    in(reg) &amp;FMT as *const u8,
    );

    0
}

#[panic_handler]
fn panic(_info: &amp;PanicInfo) -&gt; ! {
    loop {}
}
</code></pre>
<p class="my-4 tracking-wide">We build with:</p>
<pre class="border border-gray-300 rounded-md p-4 my-2 overflow-x-auto"><code class="language-bash highlight">cargo +nightly build --release
</code></pre>
<p class="my-4 tracking-wide">~<strong>‚ö†Ô∏è¬†Note:</strong> At the time of this writing the <code style="word-break:break-word" class="bg-gray-100 dark:bg-gray-800 p-1 rounded-md text-red-600 dark:text-amber-300">bpfel-unknown-none</code> target is only available on <code style="word-break:break-word" class="bg-gray-100 dark:bg-gray-800 p-1 rounded-md text-red-600 dark:text-amber-300">nightly</code>~</p>
<p class="my-4 tracking-wide"><strong>[Edit: This actually does work on <code style="word-break:break-word" class="bg-gray-100 dark:bg-gray-800 p-1 rounded-md text-red-600 dark:text-amber-300">stable</code>. Thank you to <em class="italic">niklaskorz</em> for pointing out the correction <a class="text-blue-500 hover:text-blue-600 underline" href="https://lobste.rs/s/9m8ala/bpf_from_scratch_rust#c_ci7tzt">here</a>.]</strong></p>
<p class="my-4 tracking-wide">To run this. You need to install <code style="word-break:break-word" class="bg-gray-100 dark:bg-gray-800 p-1 rounded-md text-red-600 dark:text-amber-300">yeet</code> which can be done via:</p>
<pre class="border border-gray-300 rounded-md p-4 my-2 overflow-x-auto"><code class="language-bash highlight">curl -fsSL https://yeet.cx | sh
</code></pre>
<p class="my-4 tracking-wide">This script installs both the <code style="word-break:break-word" class="bg-gray-100 dark:bg-gray-800 p-1 rounded-md text-red-600 dark:text-amber-300">yeet</code> CLI and the yeet system daemon / dynamic runtime <code style="word-break:break-word" class="bg-gray-100 dark:bg-gray-800 p-1 rounded-md text-red-600 dark:text-amber-300">yeetd</code></p>
<p class="my-4 tracking-wide">Finally, to get <code style="word-break:break-word" class="bg-gray-100 dark:bg-gray-800 p-1 rounded-md text-red-600 dark:text-amber-300">yeetd</code> to recognize and run your freshly built BPF program, you‚Äôll need to add a <code style="word-break:break-word" class="bg-gray-100 dark:bg-gray-800 p-1 rounded-md text-red-600 dark:text-amber-300">YEET</code> file to the root of your project:</p>
<pre class="border border-gray-300 rounded-md p-4 my-2 overflow-x-auto"><code class="language-toml highlight">[info]
name = &quot;bpf-from-scratch&quot;
object = &quot;target/bpfel-unknown-none/release/bpf-from-scratch&quot;
</code></pre>
<p class="my-4 tracking-wide">This file is <strong>analogous to a systemd service file</strong> ‚Äî it‚Äôs a simple descriptor that tells <code style="word-break:break-word" class="bg-gray-100 dark:bg-gray-800 p-1 rounded-md text-red-600 dark:text-amber-300">yeetd</code> where your BPF program is located on the file system and where you can supply configuration on how you want <code style="word-break:break-word" class="bg-gray-100 dark:bg-gray-800 p-1 rounded-md text-red-600 dark:text-amber-300">yeetd</code> to dynamically link and load the BPF object into the kernel.</p>
<p class="my-4 tracking-wide">We can register this newly created BPF object with the daemon by running the following command inside of the root of your rust project.</p>
<pre class="border border-gray-300 rounded-md p-4 my-2 overflow-x-auto"><code class="language-bash highlight">sudo yeet add .
</code></pre>
<p class="my-4 tracking-wide">Followed by a <code style="word-break:break-word" class="bg-gray-100 dark:bg-gray-800 p-1 rounded-md text-red-600 dark:text-amber-300">start</code> command:</p>
<pre class="border border-gray-300 rounded-md p-4 my-2 overflow-x-auto"><code class="language-bash highlight">sudo yeet start bpf-from-scratch
</code></pre>
<p class="my-4 tracking-wide">You can verify it started correctly by running:</p>
<pre class="border border-gray-300 rounded-md p-4 my-2 overflow-x-auto"><code class="language-bash highlight">sudo yeet ls
</code></pre>
<p class="my-4 tracking-wide">To see the output we can write:</p>
<pre class="border border-gray-300 rounded-md p-4 my-2 overflow-x-auto"><code class="language-bash highlight">sudo yeet trace
</code></pre>
<p class="my-4 tracking-wide">The result should be:</p>
<pre class="border border-gray-300 rounded-md p-4 my-2 overflow-x-auto"><code class="language-bash highlight">tailscaled-714     [001] ...21  2166.021924: bpf_trace_printk: hello kernel 29252
tailscaled-714     [001] ...21  2166.021999: bpf_trace_printk: hello kernel 29253
tailscaled-714     [001] ...21  2166.022033: bpf_trace_printk: hello kernel 29254
tailscaled-714     [001] ...21  2166.022114: bpf_trace_printk: hello kernel 29255
tailscaled-714     [001] ...21  2166.022189: bpf_trace_printk: hello kernel 29256
tailscaled-714     [001] ...21  2166.022264: bpf_trace_printk: hello kernel 29257
tailscaled-714     [001] ...21  2166.022338: bpf_trace_printk: hello kernel 29258
tailscaled-714     [001] ...21  2166.022412: bpf_trace_printk: hello kernel 29259
tailscaled-714     [001] ...21  2166.022486: bpf_trace_printk: hello kernel 29260
tailscaled-714     [001] ...21  2166.022580: bpf_trace_printk: hello kernel 29261
tailscaled-714     [001] ...21  2166.022714: bpf_trace_printk: hello kernel 29262
tailscaled-714     [001] ...21  2166.022928: bpf_trace_printk: hello kernel 29263
tailscaled-714     [001] ...21  2166.023302: bpf_trace_printk: hello kernel 29264
tailscaled-714     [001] ...21  2166.023997: bpf_trace_printk: hello kernel 29265
tailscaled-714     [001] ...21  2166.025337: bpf_trace_printk: hello kernel 29266
tailscaled-714     [001] ...21  2166.027952: bpf_trace_printk: hello kernel 29267
tailscaled-714     [001] ...21  2166.033131: bpf_trace_printk: hello kernel 29268
tailscaled-714     [001] ...21  2166.041890: bpf_trace_printk: hello kernel 29269
tailscaled-714     [001] ...21  2166.041965: bpf_trace_printk: hello kernel 29270
tailscaled-714     [001] ...21  2166.042218: bpf_trace_printk: hello kernel 29271
tailscaled-714     [001] ...21  2166.042293: bpf_trace_printk: hello kernel 29272
tailscaled-714     [001] ...21  2166.049350: bpf_trace_printk: hello kernel 29273
tailscaled-714     [001] ...21  2166.049425: bpf_trace_printk: hello kernel 29274
tailscaled-714     [001] ...21  2166.064448: bpf_trace_printk: hello kernel 29275
tailscaled-714     [001] ...21  2166.064864: bpf_trace_printk: hello kernel 29276
tailscaled-714     [001] ...21  2166.071629: bpf_trace_printk: hello kernel 29277
tailscaled-714     [001] ...21  2166.083817: bpf_trace_printk: hello kernel 29278
tailscaled-714     [001] ...21  2166.084231: bpf_trace_printk: hello kernel 29279
tailscaled-714     [001] ...21  2166.093196: bpf_trace_printk: hello kernel 29280
tailscaled-714     [001] ...21  2166.105598: bpf_trace_printk: hello kernel 29281
tailscaled-714     [001] ...21  2166.106027: bpf_trace_printk: hello kernel 29282
tailscaled-714     [001] ...21  2166.108765: bpf_trace_printk: hello kernel 29283
tailscaled-714     [001] ...21  2166.109107: bpf_trace_printk: hello kernel 29284
</code></pre>
<p class="my-4 tracking-wide">You can see on this system in particular <code style="word-break:break-word" class="bg-gray-100 dark:bg-gray-800 p-1 rounded-md text-red-600 dark:text-amber-300">tailscaled</code> is triggering most of the activity on <code style="word-break:break-word" class="bg-gray-100 dark:bg-gray-800 p-1 rounded-md text-red-600 dark:text-amber-300">sys_enter_nanosleep</code></p>
<p class="my-4 tracking-wide">Finally to stop it all you need to do is:</p>
<pre class="border border-gray-300 rounded-md p-4 my-2 overflow-x-auto"><code class="language-bash highlight">sudo yeet stop bpf-from-scratch
</code></pre>
<p class="my-4 tracking-wide">You can verify it stopped correctly by running:</p>
<pre class="border border-gray-300 rounded-md p-4 my-2 overflow-x-auto"><code class="language-bash highlight">sudo yeet ls
</code></pre>
<h2 class="text-4xl font-bold tracking-tighter py-2 mt-4"><strong>‚úÇÔ∏è Stripping It Down: What You Actually Need</strong></h2>
<p class="my-4 tracking-wide">Okay, that‚Äôs the entire program ‚Äî but let‚Äôs be honest:</p>
<p class="my-4 tracking-wide">A lot of it is just scaffolding to keep the compiler and the kernel from throwing a shoe at you.</p>
<p class="my-4 tracking-wide"><span class="flex justify-center w-full"><img alt="Who throws a shoe" loading="lazy" width="700" height="700" decoding="async" data-nimg="1" style="color:transparent" srcSet="https://yeet.property/cdn-cgi/image/width=750/landing-assets/blog/bpf-from-scratch-in-rust/who-throws-a-shoe.gif 1x, https://yeet.property/cdn-cgi/image/width=1920/landing-assets/blog/bpf-from-scratch-in-rust/who-throws-a-shoe.gif 2x" src="https://yeet.property/cdn-cgi/image/width=1920/landing-assets/blog/bpf-from-scratch-in-rust/who-throws-a-shoe.gif"/></span></p>
<p class="my-4 tracking-wide">So let‚Äôs separate the interesting parts (what makes this a BPF program) from the uninteresting ones (what makes it compile without exploding).</p>
<h1 class="text-5xl font-bold tracking-tighter py-2 mt-4"><strong>üî•¬†The Interesting Bits</strong></h1>
<p class="my-4 tracking-wide">This part is what makes the whole thing tick:</p>
<pre class="border border-gray-300 rounded-md p-4 my-2 overflow-x-auto"><code class="language-rust highlight">#[link_section = &quot;tracepoint/syscalls/sys_enter_nanosleep&quot;]
#[no_mangle]
pub unsafe fn test(_ctx: *mut u8) -&gt; i32 {
    asm!(
        r#&quot;
        r1 = {0}
        r4 = *(u32 *)(r1 + 0)
        r4 += 1
        *(u32 *)(r1 + 0) = r4
        r1 = {1}
        r2 = 16
        r3 = r4
        call 6
    &quot;#,
    in(reg) &amp;raw const COUNTER as *const u64,
    in(reg) &amp;FMT as *const u8,
    );

    0
}
</code></pre>
<ul class="list-disc pl-6 my-4 space-y-1">
<li class="my-1">The <code style="word-break:break-word" class="bg-gray-100 dark:bg-gray-800 p-1 rounded-md text-red-600 dark:text-amber-300">#[link_section]</code> specifies on which of Linux‚Äôs thousands of tracepoints <code style="word-break:break-word" class="bg-gray-100 dark:bg-gray-800 p-1 rounded-md text-red-600 dark:text-amber-300">yeetd</code> should attach this code.</li>
<li class="my-1"><code style="word-break:break-word" class="bg-gray-100 dark:bg-gray-800 p-1 rounded-md text-red-600 dark:text-amber-300">test</code> is the actual entry point of the program.</li>
<li class="my-1"><code style="word-break:break-word" class="bg-gray-100 dark:bg-gray-800 p-1 rounded-md text-red-600 dark:text-amber-300">asm!</code> : Wraps raw BPF bytecode, hand-written and beamed directly into verifier hell.</li>
</ul>
<h2 class="text-4xl font-bold tracking-tighter py-2 mt-4">ü™Ñ¬†Black Magic</h2>
<p class="my-4 tracking-wide">Let‚Äôs walk through the <code style="word-break:break-word" class="bg-gray-100 dark:bg-gray-800 p-1 rounded-md text-red-600 dark:text-amber-300">asm!</code> block. It‚Äôs small, but it packs a lot ‚Äî and every line is doing something very specific:</p>
<p class="my-4 tracking-wide">From a high level, you can think of the <code style="word-break:break-word" class="bg-gray-100 dark:bg-gray-800 p-1 rounded-md text-red-600 dark:text-amber-300">asm!</code> block as being split into 2 sections:</p>
<pre class="border border-gray-300 rounded-md p-4 my-2 overflow-x-auto"><code class="language-rust highlight">asm!(
   [I. Incrementing the counter by 1]
   [II. Printing the counter&#x27;s value to the kernel&#x27;s trace pipe]
)
</code></pre>
<h3 class="text-3xl font-bold tracking-tighter py-2 mt-4">I. Incrementing the counter by 1</h3>
<p class="my-4 tracking-wide">In the first section we simply load the counter‚Äôs value from memory, increment it and store it back.</p>
<pre class="border border-gray-300 rounded-md p-4 my-2 overflow-x-auto"><code class="language-rust highlight">r1 = {memory address of COUNTER}   // r1 points to our static counter
r4 = *(u32 *)(r1 + 0)              // load the value of the counter into r4
r4 += 1                            // increment it
*(u32 *)(r1 + 0) = r4              // store it back into memory
</code></pre>
<h3 class="text-3xl font-bold tracking-tighter py-2 mt-4">II. Printing the counter‚Äôs value to the kernel‚Äôs trace pipe</h3>
<p class="my-4 tracking-wide">In BPF, helper functions like <code style="word-break:break-word" class="bg-gray-100 dark:bg-gray-800 p-1 rounded-md text-red-600 dark:text-amber-300">bpf_trace_printk()</code> are invoked using a simple <strong>register-based calling convention</strong>:</p>
<ul class="list-disc pl-6 my-4 space-y-1">
<li class="my-1">Functions can take up to 5 arguments</li>
<li class="my-1">Arguments must be loaded in order into <code style="word-break:break-word" class="bg-gray-100 dark:bg-gray-800 p-1 rounded-md text-red-600 dark:text-amber-300">r1</code> to <code style="word-break:break-word" class="bg-gray-100 dark:bg-gray-800 p-1 rounded-md text-red-600 dark:text-amber-300">r5</code></li>
<li class="my-1">The return value is passed back in <code style="word-break:break-word" class="bg-gray-100 dark:bg-gray-800 p-1 rounded-md text-red-600 dark:text-amber-300">r0</code></li>
<li class="my-1">Calls are made using the <code style="word-break:break-word" class="bg-gray-100 dark:bg-gray-800 p-1 rounded-md text-red-600 dark:text-amber-300">call</code> instruction, followed by a helper ID number, which traps back into the kernel so it can service your request similar to a system call for regular programs.</li>
</ul>
<p class="my-4 tracking-wide">In our case, we‚Äôre calling <code style="word-break:break-word" class="bg-gray-100 dark:bg-gray-800 p-1 rounded-md text-red-600 dark:text-amber-300">bpf_trace_printk()</code> (helper ID 6), which has the signature:</p>
<pre class="border border-gray-300 rounded-md p-4 my-2 overflow-x-auto"><code class="language-c highlight">int bpf_trace_printk(const char *fmt, int fmt_size, ...);
</code></pre>
<p class="my-4 tracking-wide">So in our program, we set things up like this:</p>
<pre class="border border-gray-300 rounded-md p-4 my-2 overflow-x-auto"><code class="language-rust highlight">r1 = {pointer to format string} // r1 = pointer to &quot;hello kernel %d\0&quot;
r2 = 16                         // r2 = length of the format string
r3 = r4                         // r3 = the counter value
call 6                          // call bpf_trace_printk(fmt, fmt_size, ...)
</code></pre>
<h1 class="text-5xl font-bold tracking-tighter py-2 mt-4">Conclusion</h1>
<p class="my-4 tracking-wide">You just wrote a working BPF program in raw Rust and loaded it into the kernel with <code style="word-break:break-word" class="bg-gray-100 dark:bg-gray-800 p-1 rounded-md text-red-600 dark:text-amber-300">yeet</code> ‚Äî no macros, no C, no training wheels.</p>
<p class="my-4 tracking-wide">‚úÖ¬†Hooks into the kernel</p>
<p class="my-4 tracking-wide">‚úÖ¬†Passes the verifier</p>
<p class="my-4 tracking-wide">‚úÖ¬†Prints live output to the trace pipe</p>
<p class="my-4 tracking-wide">It‚Äôs low-level, verifier-safe magic‚Ä¶ And you built it entirely from scratch, <em class="italic"><strong>in Rust!</strong></em></p>
<p class="my-4 tracking-wide">This is the kind of <strong>register allocation bars</strong> we spit every day while building <code style="word-break:break-word" class="bg-gray-100 dark:bg-gray-800 p-1 rounded-md text-red-600 dark:text-amber-300">yeet</code> ‚Äî <strong>not because we want you to suffer‚Ä¶</strong>
but because we know how to go from <strong>zero to Dre</strong> on the verifier all so you can just‚Ä¶ <code style="word-break:break-word" class="bg-gray-100 dark:bg-gray-800 p-1 rounded-md text-red-600 dark:text-amber-300">yeet start</code> and get answers.</p>
<p class="my-4 tracking-wide"><span class="flex justify-center w-full"><img alt="Dr. Dre" loading="lazy" width="700" height="700" decoding="async" data-nimg="1" style="color:transparent" srcSet="https://yeet.property/cdn-cgi/image/width=750/landing-assets/blog/bpf-from-scratch-in-rust/dre.gif 1x, https://yeet.property/cdn-cgi/image/width=1920/landing-assets/blog/bpf-from-scratch-in-rust/dre.gif 2x" src="https://yeet.property/cdn-cgi/image/width=1920/landing-assets/blog/bpf-from-scratch-in-rust/dre.gif"/></span></p>
<p class="my-4 tracking-wide">Wanna see how far down the BPF rabbit hole goes? Check out our <a class="text-blue-500 hover:text-blue-600 underline" href="https://yeet.cx/play">sandbox</a></p>
<p class="my-4 tracking-wide">You can also see what packages we have available via the <a class="text-blue-500 hover:text-blue-600 underline" href="https://yeet.cx/discover">yeet package manager</a>
which is our ever-growing package index of pre-made BPF packages.</p>
<p class="my-4 tracking-wide">Welcome to ring-zero. Welcome to <code style="word-break:break-word" class="bg-gray-100 dark:bg-gray-800 p-1 rounded-md text-red-600 dark:text-amber-300">yeet</code></p>
<p class="my-4 tracking-wide"><span class="flex justify-center w-full"><img alt="Knibb High Football Rules" loading="lazy" width="700" height="700" decoding="async" data-nimg="1" style="color:transparent" srcSet="https://yeet.property/cdn-cgi/image/width=750/landing-assets/blog/bpf-from-scratch-in-rust/knibb-high-football-rules.gif 1x, https://yeet.property/cdn-cgi/image/width=1920/landing-assets/blog/bpf-from-scratch-in-rust/knibb-high-football-rules.gif 2x" src="https://yeet.property/cdn-cgi/image/width=1920/landing-assets/blog/bpf-from-scratch-in-rust/knibb-high-football-rules.gif"/></span></p></div><footer class="w-full p-4 text-xs grid grid-cols-1 gap-4"><div class="w-full flex justify-center"><div class="w-fit h-fit p-2 flex justify-center gap-4 dark:filter-none invert"><div class="transition hover:scale-110 cursor-pointer"><a id="social-links-discord" href="https://discord.gg/bBRF9d2Gw2"><img alt="Discord" loading="lazy" width="32" height="32" decoding="async" data-nimg="1" style="color:transparent" srcSet="https://yeet.property/cdn-cgi/image/width=32/landing-assets/social_logos/discord.png 1x, https://yeet.property/cdn-cgi/image/width=64/landing-assets/social_logos/discord.png 2x" src="https://yeet.property/cdn-cgi/image/width=64/landing-assets/social_logos/discord.png"/></a></div><div class="transition hover:scale-110 cursor-pointer"><a id="social-links-github" href="https://github.com/yeet-src"><img alt="GitHub" loading="lazy" width="32" height="32" decoding="async" data-nimg="1" style="color:transparent" srcSet="https://yeet.property/cdn-cgi/image/width=32/landing-assets/social_logos/github.png 1x, https://yeet.property/cdn-cgi/image/width=64/landing-assets/social_logos/github.png 2x" src="https://yeet.property/cdn-cgi/image/width=64/landing-assets/social_logos/github.png"/></a></div><div class="transition hover:scale-110 cursor-pointer"><a id="social-links-youtube" href="https://www.youtube.com/@yeet-z9u"><img alt="YouTube" loading="lazy" width="32" height="32" decoding="async" data-nimg="1" style="color:transparent" srcSet="https://yeet.property/cdn-cgi/image/width=32/landing-assets/social_logos/youtube.png 1x, https://yeet.property/cdn-cgi/image/width=64/landing-assets/social_logos/youtube.png 2x" src="https://yeet.property/cdn-cgi/image/width=64/landing-assets/social_logos/youtube.png"/></a></div></div></div><div class="w-full flex p-2 justify-center"><a id="we-are-hiring" class=" text-xl w-fit border-b-1 border-white dark:border-black hover:dark:border-white hover:border-black " href="/careers"><span class="inline-block font-bold font-runescape tracking-wider">We&#x27;re Hiring!</span></a></div><div class="w-full py-4 flex lg:flex-row flex-col items-center justify-center gap-2"><a class="hover:underline" href="/tos">Terms of Service</a><a class="hover:underline" href="/privacy">Privacy Policy</a></div><p class="text-center">¬© <!-- -->2025<!-- --> Virt Inc. All Rights Reserved.</p></footer><script src="https://yeet.cx/landing-assets/_next/static/chunks/webpack-a1f87996eace2985.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"https://yeet.cx/landing-assets/_next/static/media/e4af272ccee01ff0-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n2:HL[\"https://yeet.cx/landing-assets/_next/static/css/bcc59eca98b71e9e.css\",\"style\"]\n3:HL[\"https://yeet.cx/landing-assets/_next/static/css/e142c0e1edc5ec2b.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"4:I[12846,[],\"\"]\n6:I[19107,[],\"ClientPageRoot\"]\n7:I[83619,[\"5878\",\"static/chunks/9da6db1e-04e8cfb07900d0e9.js\",\"8938\",\"static/chunks/b4938aab-d2bdb82c799a9985.js\",\"9560\",\"static/chunks/9560-bc97d5c48e0404b5.js\",\"605\",\"static/chunks/605-a76a7fa5deaa64f3.js\",\"7930\",\"static/chunks/7930-c02b706647238efd.js\",\"1166\",\"static/chunks/1166-eae33ead6c03129f.js\",\"5437\",\"static/chunks/5437-eafa6373ab6aaff8.js\",\"1740\",\"static/chunks/1740-3c33bac6317a6815.js\",\"702\",\"static/chunks/702-95471d26c1713cd1.js\",\"1394\",\"static/chunks/1394-5f691a7052e7110f.js\",\"2288\",\"static/chunks/2288-2f7ff08a5c9ef7ac.js\",\"1270\",\"static/chunks/1270-1ec7192372faba91.js\",\"1237\",\"static/chunks/1237-9a220d7e3f5b5206.js\",\"308\",\"static/chunks/app/blog/%5Bslug%5D/page-98fb4bb0a6e14b7d.js\"],\"default\",1]\n9:I[4707,[],\"\"]\na:I[36423,[],\"\"]\nb:I[35797,[\"9560\",\"static/chunks/9560-bc97d5c48e0404b5.js\",\"605\",\"static/chunks/605-a76a7fa5deaa64f3.js\",\"7930\",\"static/chunks/7930-c02b706647238efd.js\",\"5240\",\"static/chunks/5240-bddfc6431af5ad58.js\",\"3206\",\"static/chunks/app/blog/%5Bslug%5D/layout-f23ba9febc31ddc4.js\"],\"SessionProvider\"]\nc:I[9183,[\"5878\",\"static/chunks/9da6db1e-04e8cfb07900d0e9.js\",\"605\",\"static/chunks/605-a76a7fa5deaa64f3.js\",\"1166\",\"static/chunks/1166-eae33ead6c03129f.js\",\"3185\",\"static/chunks/app/layout-e150284872b32f1b.js\"],\"default\"]\nd:I[15952,[\"5878\",\"static/chunks/9da6db1e-04e8cfb07900d0e9.js\",\"605\",\"static/chunks/605-a76a7fa5deaa64f3.js\",\"1166\",\"static/chunks/1166-eae33ead6c03129f.js\",\"3185\",\"static/chunks/app/layout-e150284872b32f1b.js\"],\"default\"]\ne:I[16144,[\"5878\",\"static/chunks/9da6db1e-04e8cfb07900d0e9.js\",\"605\",\"static/chunks/605-a76a7fa5deaa64f3.js\",\"1166\",\"static/chunks/1166-eae33ead6c03129f.js\",\"3185\",\"static/chunks/app/layout-e150284872b32f1b.js\"],\"PostHogProvider\"]\nf:I[56539,[\"5878\",\"static/chunks/9da6db1e-04e8cfb07900d0e9.js\",\"605\",\"static/chunks/605-a76a7fa5deaa64f3.js\",\"1166\",\"static/chunks/1166-eae33ead6c03129f.js\",\"3185\",\"static/chunks/app/layout-e150284872b32f1b.js\"],\"BrevoConversationsProvider\"]\n10:I[72972,[\"9560\",\"static/chunks/9560"])</script><script>self.__next_f.push([1,"-bc97d5c48e0404b5.js\",\"605\",\"static/chunks/605-a76a7fa5deaa64f3.js\",\"7930\",\"static/chunks/7930-c02b706647238efd.js\",\"5240\",\"static/chunks/5240-bddfc6431af5ad58.js\",\"3206\",\"static/chunks/app/blog/%5Bslug%5D/layout-f23ba9febc31ddc4.js\"],\"\"]\n11:I[65878,[\"9560\",\"static/chunks/9560-bc97d5c48e0404b5.js\",\"605\",\"static/chunks/605-a76a7fa5deaa64f3.js\",\"7930\",\"static/chunks/7930-c02b706647238efd.js\",\"5240\",\"static/chunks/5240-bddfc6431af5ad58.js\",\"3206\",\"static/chunks/app/blog/%5Bslug%5D/layout-f23ba9febc31ddc4.js\"],\"Image\"]\n12:I[73202,[\"9560\",\"static/chunks/9560-bc97d5c48e0404b5.js\",\"9160\",\"static/chunks/app/not-found-b012be08d98b8ed6.js\"],\"default\"]\n14:I[61060,[],\"\"]\n15:[]\n"])</script><script>self.__next_f.push([1,"0:[\"$\",\"$L4\",null,{\"buildId\":\"JspoX0wpP9QgE96bJRR6I\",\"assetPrefix\":\"https://yeet.cx/landing-assets\",\"urlParts\":[\"\",\"blog\",\"bpf-from-scratch-in-rust\"],\"initialTree\":[\"\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"bpf-from-scratch-in-rust\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],\"initialSeedData\":[\"\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"bpf-from-scratch-in-rust\",\"d\"],{\"children\":[\"__PAGE__\",{},[[\"$L5\",[\"$\",\"$L6\",null,{\"props\":{\"params\":{\"slug\":\"bpf-from-scratch-in-rust\"},\"searchParams\":{}},\"Component\":\"$7\"}],[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"https://yeet.cx/landing-assets/_next/static/css/e142c0e1edc5ec2b.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]]],null],null]},[[null,\"$L8\"],null],null]},[null,[\"$\",\"$L9\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\"}]],null]},[[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"https://yeet.cx/landing-assets/_next/static/css/bcc59eca98b71e9e.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"className\":\"scroll-smooth bg-white dark:bg-black antialiased __variable_e39583\",\"children\":[[\"$\",\"head\",null,{\"children\":[[[\"$\",\"link\",\"preconnect:https://yeet.property\",{\"rel\":\"preconnect\",\"href\":\"https://yeet.property\",\"crossOrigin\":\"anonymous\"}]],[[\"$\",\"link\",\"preload:https://yeet.property/landing-assets/fonts/Iosevka_33.2.8/Iosevka-Thin.woff2\",{\"rel\":\"preload\",\"as\":\"font\",\"href\":\"https://yeet.property/landing-assets/fonts/Iosevka_33.2.8/Iosevka-Thin.woff2\",\"type\":\"font/woff2\",\"crossOrigin\":\"anonymous\"}],[\"$\",\"link\",\"preload:https://yeet.property/landing-assets/fonts/Iosevka_33.2.8/Iosevka-ExtraLight.woff2\",{\"rel\":\"preload\",\"as\":\"font\",\"href\":\"https://yeet.property/landing-assets/fonts/Iosevka_33.2.8/Iosevka-ExtraLight.woff2\",\"type\":\"font/woff2\",\"crossOrigin\":\"anonymous\"}],[\"$\",\"link\",\"preload:https://yeet.property/landing-assets/fonts/Iosevka_33.2.8/Iosevka-Light.woff2\",{\"rel\":\"preload\",\"as\":\"font\",\"href\":\"https://yeet.property/landing-assets/fonts/Iosevka_33.2.8/Iosevka-Light.woff2\",\"type\":\"font/woff2\",\"crossOrigin\":\"anonymous\"}],[\"$\",\"link\",\"preload:https://yeet.property/landing-assets/fonts/Iosevka_33.2.8/Iosevka-Regular.woff2\",{\"rel\":\"preload\",\"as\":\"font\",\"href\":\"https://yeet.property/landing-assets/fonts/Iosevka_33.2.8/Iosevka-Regular.woff2\",\"type\":\"font/woff2\",\"crossOrigin\":\"anonymous\"}],[\"$\",\"link\",\"preload:https://yeet.property/landing-assets/fonts/Iosevka_33.2.8/Iosevka-Medium.woff2\",{\"rel\":\"preload\",\"as\":\"font\",\"href\":\"https://yeet.property/landing-assets/fonts/Iosevka_33.2.8/Iosevka-Medium.woff2\",\"type\":\"font/woff2\",\"crossOrigin\":\"anonymous\"}],[\"$\",\"link\",\"preload:https://yeet.property/landing-assets/fonts/Iosevka_33.2.8/Iosevka-SemiBold.woff2\",{\"rel\":\"preload\",\"as\":\"font\",\"href\":\"https://yeet.property/landing-assets/fonts/Iosevka_33.2.8/Iosevka-SemiBold.woff2\",\"type\":\"font/woff2\",\"crossOrigin\":\"anonymous\"}],[\"$\",\"link\",\"preload:https://yeet.property/landing-assets/fonts/Iosevka_33.2.8/Iosevka-Bold.woff2\",{\"rel\":\"preload\",\"as\":\"font\",\"href\":\"https://yeet.property/landing-assets/fonts/Iosevka_33.2.8/Iosevka-Bold.woff2\",\"type\":\"font/woff2\",\"crossOrigin\":\"anonymous\"}],[\"$\",\"link\",\"preload:https://yeet.property/landing-assets/fonts/Iosevka_33.2.8/Iosevka-ExtraBold.woff2\",{\"rel\":\"preload\",\"as\":\"font\",\"href\":\"https://yeet.property/landing-assets/fonts/Iosevka_33.2.8/Iosevka-ExtraBold.woff2\",\"type\":\"font/woff2\",\"crossOrigin\":\"anonymous\"}],[\"$\",\"link\",\"preload:https://yeet.property/landing-assets/fonts/Iosevka_33.2.8/Iosevka-Heavy.woff2\",{\"rel\":\"preload\",\"as\":\"font\",\"href\":\"https://yeet.property/landing-assets/fonts/Iosevka_33.2.8/Iosevka-Heavy.woff2\",\"type\":\"font/woff2\",\"crossOrigin\":\"anonymous\"}],[\"$\",\"link\",\"preload:https://yeet.property/landing-assets/fonts/RuneScape/RuneScape-Bold-12.woff2\",{\"rel\":\"preload\",\"as\":\"font\",\"href\":\"https://yeet.property/landing-assets/fonts/RuneScape/RuneScape-Bold-12.woff2\",\"type\":\"font/woff2\",\"crossOrigin\":\"anonymous\"}]]]}],[\"$\",\"body\",null,{\"children\":[\"$\",\"$Lb\",null,{\"children\":[[\"$\",\"$Lc\",null,{}],[\"$\",\"$Ld\",null,{}],[\"$\",\"$Le\",null,{\"children\":[\"$\",\"$Lf\",null,{\"children\":[\"$\",\"$L9\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[\"$\",\"main\",null,{\"className\":\"w-screen h-screen max-h-full bg-black text-white\",\"children\":[\"$\",\"div\",null,{\"className\":\"w-full h-full relative\",\"children\":[[\"$\",\"div\",null,{\"className\":\"w-full h-full absolute inset-0 flex items-center justify-center z-10\",\"children\":[\"$\",\"div\",null,{\"className\":\" text-center p-2 bg-black/30 rounded-full grid grid-cols-1 gap-6 justify-center \",\"children\":[[\"$\",\"div\",null,{\"className\":\"flex w-full justify-center\",\"children\":[\"$\",\"$L10\",null,{\"href\":\"/\",\"children\":[\"$\",\"$L11\",null,{\"className\":\"hover:scale-110 transition\",\"src\":\"/fecm.png\",\"alt\":\"yeet\",\"width\":80,\"height\":80}]}]}],[\"$\",\"p\",null,{\"className\":\"md:text-4xl text-2xl font-extrabold\",\"children\":\"We couldn't find that.\"}],[\"$\",\"div\",null,{\"className\":\"w-full flex justify-center\",\"children\":[\"$\",\"$L10\",null,{\"href\":\"/\",\"className\":\" py-2 px-4 w-fit h-fit rounded-lg text-xl font-medium bg-white text-black hover:opacity-90 \",\"children\":[\"Go home \",[\"$\",\"span\",null,{\"className\":\"ml-1\",\"children\":\"üè†\"}]]}]}]]}]}],[\"$\",\"div\",null,{\"className\":\"w-full h-full absolute inset-0 flex items-center justify-center\",\"children\":[\"$\",\"$L12\",null,{}]}]]}]}],\"notFoundStyles\":[]}]}]}]]}]}]]}]],null],null],\"couldBeIntercepted\":false,\"initialHead\":[null,\"$L13\"],\"globalErrorComponent\":\"$14\",\"missingSlots\":\"$W15\"}]\n"])</script><script>self.__next_f.push([1,"16:I[2290,[\"9560\",\"static/chunks/9560-bc97d5c48e0404b5.js\",\"605\",\"static/chunks/605-a76a7fa5deaa64f3.js\",\"7930\",\"static/chunks/7930-c02b706647238efd.js\",\"5240\",\"static/chunks/5240-bddfc6431af5ad58.js\",\"3206\",\"static/chunks/app/blog/%5Bslug%5D/layout-f23ba9febc31ddc4.js\"],\"default\"]\n17:I[33968,[\"9560\",\"static/chunks/9560-bc97d5c48e0404b5.js\",\"605\",\"static/chunks/605-a76a7fa5deaa64f3.js\",\"7930\",\"static/chunks/7930-c02b706647238efd.js\",\"5240\",\"static/chunks/5240-bddfc6431af5ad58.js\",\"3206\",\"static/chunks/app/blog/%5Bslug%5D/layout-f23ba9febc31ddc4.js\"],\"default\"]\n19:I[80332,[\"9560\",\"static/chunks/9560-bc97d5c48e0404b5.js\",\"605\",\"static/chunks/605-a76a7fa5deaa64f3.js\",\"7930\",\"static/chunks/7930-c02b706647238efd.js\",\"5240\",\"static/chunks/5240-bddfc6431af5ad58.js\",\"3206\",\"static/chunks/app/blog/%5Bslug%5D/layout-f23ba9febc31ddc4.js\"],\"default\"]\n18:[\"slug\",\"bpf-from-scratch-in-rust\",\"d\"]\n"])</script><script>self.__next_f.push([1,"8:[[\"$\",\"div\",null,{\"className\":\"sticky h-fit top-0 z-20 flex flex-col\",\"children\":[[\"$\",\"$L16\",null,{}],[\"$\",\"$L17\",null,{}]]}],[\"$\",\"div\",null,{\"className\":\"max-w-xs min-w-0 sm:max-w-md md:max-w-3xl mx-auto my-16\",\"children\":[\"$\",\"$Lb\",null,{\"children\":[\"$\",\"$L9\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\",\"$18\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\"}]}]}],[\"$\",\"footer\",null,{\"className\":\"w-full p-4 text-xs grid grid-cols-1 gap-4\",\"children\":[[\"$\",\"div\",null,{\"className\":\"w-full flex justify-center\",\"children\":[\"$\",\"div\",null,{\"className\":\"w-fit h-fit p-2 flex justify-center gap-4 dark:filter-none invert\",\"children\":[[\"$\",\"div\",null,{\"className\":\"transition hover:scale-110 cursor-pointer\",\"children\":[\"$\",\"$L10\",null,{\"id\":\"social-links-discord\",\"href\":\"https://discord.gg/bBRF9d2Gw2\",\"children\":[\"$\",\"$L11\",null,{\"src\":\"/social_logos/discord.png\",\"alt\":\"Discord\",\"width\":32,\"height\":32}]}]}],[\"$\",\"div\",null,{\"className\":\"transition hover:scale-110 cursor-pointer\",\"children\":[\"$\",\"$L10\",null,{\"id\":\"social-links-github\",\"href\":\"https://github.com/yeet-src\",\"children\":[\"$\",\"$L11\",null,{\"src\":\"/social_logos/github.png\",\"alt\":\"GitHub\",\"width\":32,\"height\":32}]}]}],[\"$\",\"div\",null,{\"className\":\"transition hover:scale-110 cursor-pointer\",\"children\":[\"$\",\"$L10\",null,{\"id\":\"social-links-youtube\",\"href\":\"https://www.youtube.com/@yeet-z9u\",\"children\":[\"$\",\"$L11\",null,{\"src\":\"/social_logos/youtube.png\",\"alt\":\"YouTube\",\"width\":32,\"height\":32}]}]}]]}]}],[\"$\",\"div\",null,{\"className\":\"w-full flex p-2 justify-center\",\"children\":[\"$\",\"$L19\",null,{}]}],[\"$\",\"div\",null,{\"className\":\"w-full py-4 flex lg:flex-row flex-col items-center justify-center gap-2\",\"children\":[[\"$\",\"$L10\",null,{\"className\":\"hover:underline\",\"href\":\"/tos\",\"children\":\"Terms of Service\"}],[\"$\",\"$L10\",null,{\"className\":\"hover:underline\",\"href\":\"/privacy\",\"children\":\"Privacy Policy\"}]]}],[\"$\",\"p\",null,{\"className\":\"text-center\",\"children\":[\"¬© \",2025,\" Virt Inc. All Rights Reserved.\"]}]]}]]\n"])</script><script>self.__next_f.push([1,"13:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"1\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"2\",{\"children\":\"BPF from Scratch in Rust\"}],[\"$\",\"meta\",\"3\",{\"name\":\"description\",\"content\":\"How to write a BPF program from scratch in pure Rust.\"}],[\"$\",\"meta\",\"4\",{\"property\":\"og:title\",\"content\":\"BPF from Scratch in Rust\"}],[\"$\",\"meta\",\"5\",{\"property\":\"og:description\",\"content\":\"How to write a BPF program from scratch in pure Rust.\"}],[\"$\",\"meta\",\"6\",{\"property\":\"og:image\",\"content\":\"https://yeet.property/cdn-cgi/image/width=1200,height=620/landing-assets/blog/bpf-from-scratch-in-rust/opengraph-image.png\"}],[\"$\",\"meta\",\"7\",{\"property\":\"og:image:width\",\"content\":\"1200\"}],[\"$\",\"meta\",\"8\",{\"property\":\"og:image:height\",\"content\":\"620\"}],[\"$\",\"meta\",\"9\",{\"name\":\"twitter:card\",\"content\":\"summary_large_image\"}],[\"$\",\"meta\",\"10\",{\"name\":\"twitter:title\",\"content\":\"BPF from Scratch in Rust\"}],[\"$\",\"meta\",\"11\",{\"name\":\"twitter:description\",\"content\":\"How to write a BPF program from scratch in pure Rust.\"}],[\"$\",\"meta\",\"12\",{\"name\":\"twitter:image\",\"content\":\"https://yeet.property/cdn-cgi/image/width=1200,height=620/landing-assets/blog/bpf-from-scratch-in-rust/opengraph-image.png\"}],[\"$\",\"meta\",\"13\",{\"name\":\"twitter:image:width\",\"content\":\"1200\"}],[\"$\",\"meta\",\"14\",{\"name\":\"twitter:image:height\",\"content\":\"620\"}],[\"$\",\"link\",\"15\",{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"144x135\"}],[\"$\",\"meta\",\"16\",{\"name\":\"next-size-adjust\"}]]\n5:null\n"])</script></body></html>